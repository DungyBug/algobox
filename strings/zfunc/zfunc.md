# Z-Функция
Z-функция от строки *S* применяется для нахождения z-массива - набора значений, где *i-ый* элемент хранит значение максимальной длины подстроки *p*, которая является префиксом *S* ( т.е. является началом строки *S* ) и начинается с *i-ой* позиции строки *S*.

Z-функция от строки *S* применяется для нахождения z-массива - набора значений, где каждый элемент содержит максимальную длину подстроки *p*, которая является началом *S* и начинается с текущего элемента.

Приведём пример z-массива для строки `dbdcdbdadc`:
| d | b | d | c | d | b | d | a | d | c |
|---|---|---|---|---|---|---|---|---|---|
|   | 0 | 1 | 0 | 3 | 0 | 1 | 0 | 1 | 0 |

Наивная реализация:

```cpp
#include <vector>
#include <string>
#include <stdint.h>

std::vector<uint64_t> zfuncNaive(const std::string &str) {
    uint64_t size = str.size();
    
    std::vector<uint64_t> zvalues(size, 0);

    for(uint64_t i = 1; i < size; i++) {
        uint64_t currentPrefixLen = 0;

        while(i + currentPrefixLen < size && str[i + currentPrefixLen] == str[currentPrefixLen]) {
            currentPrefixLen++;
        }

        zvalues[i] = currentPrefixLen;
    }

    return zvalues;
}
```

Производительность такого решения ( в секундах ) приведена ниже:

| Размер строки | Минимальное время | Среднее время | Максимальное время |
|---------------|-------------------|---------------|--------------------|
| 10            | 0.000000          | 0.000000      | 0.000000           |
| 100           | 0.000000          | 0.000001      | 0.000018           |
| 1000          | 0.000006          | 0.000039      | 0.001775           |
| 10000         | 0.000068          | 0.000357      | 0.179535           |
| 100000        | 0.000681          | 0.003606      | 16.909692          |
| 1000000       | 0.006818          | 0.032918      | >60.000000         |

Характеристики решения представлены ниже:

| Худший случай     | O(n²) |
|-------------------|-------|
| Лучший случай     | O(n)  |

### Оптимизация

Реализация z-функции в `zfunc.hpp` во всех случаях имеет сложность `O(n)`.

Таблица производительности на тех же данных в секундах представлена ниже:

| Размер строки | Минимальное время | Среднее время | Максимальное время |
|---------------|-------------------|---------------|--------------------|
| 10            | 0.000000          | 0.000000      | 0.000001           |
| 100           | 0.000000          | 0.000000      | 0.000001           |
| 1000          | 0.000008          | 0.000012      | 0.000049           |
| 10000         | 0.000079          | 0.000125      | 0.000221           |
| 100000        | 0.000793          | 0.001269      | 0.003430           |
| 1000000       | 0.007961          | 0.012682      | 0.030952           |

Характеристики решения представлены ниже:

| Худший случай     | O(n)  |
|-------------------|-------|
| Лучший случай     | O(n)  |

Замеры для наивного и эффективных решений проводились на одинаковых наборах данных. Строки генерировались как с повышенным количеством префиксов в ней, так и полностью случайно.