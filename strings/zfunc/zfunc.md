# Z-Функция
Z-функция от строки *S* применяется для нахождения z-массива - набора значений, где каждый элемент содержит максимальную длину подстроки *p*, которая является началом *S* и начинается с текущего элемента.

Приведём пример z-массива для строки `dbdcdbdadc`:
| d | b | d | c | d | b | d | a | d | c |
|---|---|---|---|---|---|---|---|---|---|
|   | 0 | 1 | 0 | 3 | 0 | 1 | 0 | 1 | 0 |

Наивная реализация:

```cpp
#include <vector>
#include <string>
#include <stdint.h>

std::vector<uint64_t> zfuncNaive(const std::string &str) {
    uint64_t size = str.size();
    
    std::vector<uint64_t> zvalues(size, 0);

    for(uint64_t i = 1; i < size; i++) {
        uint64_t currentPrefixLen = 0;

        while(i + currentPrefixLen < size && str[i + currentPrefixLen] == str[currentPrefixLen]) {
            currentPrefixLen++;
        }

        zvalues[i] = currentPrefixLen;
    }

    return zvalues;
}
```

Производительность такого решения ( в секундах ) приведена ниже:

| Размер строки | Минимальное время | Среднее время | Максимальное время |
|---------------|-------------------|---------------|--------------------|
| 10            | 0.000000          | 0.000000      | 0.000000           |
| 100           | 0.000000          | 0.000002      | 0.000018           |
| 1000          | 0.000007          | 0.000120      | 0.001882           |
| 10000         | 0.000070          | 0.011120      | 0.231889           |
| 100000        | 0.000647          | 1.080672      | 17.391248          |
| 1000000       | 0.006818          | >60.000000    | >60.000000         |

Характеристики решения представлены ниже:

| Худший случай     | O(n²) |
|-------------------|-------|
| Лучший случай     | O(n)  |

### Оптимизация

Реализация z-функции в `zfunc.hpp` во всех случаях имеет сложность `O(n)`.

Таблица производительности на тех же данных в секундах представлена ниже:

| Размер строки | Минимальное время | Среднее время | Максимальное время |
|---------------|-------------------|---------------|--------------------|
| 10            | 0.000000          | 0.000000      | 0.000005           |
| 100           | 0.000000          | 0.000000      | 0.000002           |
| 1000          | 0.000006          | 0.000009      | 0.000023           |
| 10000         | 0.000057          | 0.000096      | 0.000154           |
| 100000        | 0.000576          | 0.000951      | 0.001380           |
| 1000000       | 0.005782          | 0.009597      | 0.014301           |

Характеристики решения представлены ниже:

| Худший случай     | O(n)  |
|-------------------|-------|
| Лучший случай     | O(n)  |

Замеры для наивного и эффективных решений проводились на одинаковых наборах данных. Строки генерировались как с повышенным количеством префиксов в ней, так и полностью случайно.

**Важно: z-функция может иметь бОльшую по сравнению с наивным решением константу, из-за чего она может оказаться медленнее наивного решения.**